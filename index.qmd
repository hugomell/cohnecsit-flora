---
title: "Can linear transportation infrastructure verges constitute a habitat and/or a corridor for vascular plants in temperate ecosystems? A systematic review"
execute:
  echo: false
  warning: false
bibliography: references.bib
csl: vancouver-brackets.csl
format:
  docx: 
    reference-doc: custom-reference-doc.docx
---


**Abstract**

*TODO*

Initiales : SV : Sylvie Vanpeene, AV : Anne Villemey, AJ : Arzhvaël Jeusset,
RS : Romain Sordello, MV : Marianne Vargac, EG : Eric Guinard, EM : Eric le
Mitouard, VR : Vanessa Rauel, AC : Aurélie Coulon, YB : Yves Bertheau, LP :
Louise Percevault, VF : Vinciane Fack, PP : Patrick Pacevicius, VA : Vital
Azambourg, YR : Yorick Reyjol 

 
# Background

For the last decades, human activities have resulted in a global continuous
loss of biodiversity [@butchart_global_2010], and transportation was identified
as one of the ten major threats faced by threatened or near-threatened species
[@maxwell_biodiversity_2016]. Linear transportation infrastructures (LTIs) have
led to habitat loss and degradation, fragmentation and barrier effects, light
and noise disturbance, chemical pollution and direct mortality (e.g. road kill,
electrocution)
[@bekker_habitat_2003; @biasotto_power_2018; @dorsey_ecological_2015; @feranec_european_2016; @richardson_review_2017; @trombulak_review_2000]
.
In particular, the splitting of natural habitats and ecosystems into smaller and
more isolated patches (i.e. fragmentation) and the associated loss of habitat
have negative effects on biodiversity [@krauss_habitat_2010]. For instance,
LTIs have induced a decrease in wildlife species abundance at local and large
scales [@benitez-lopez_impacts_2010]. And, through barrier effects LTIs can
restrict wildlife movements, disrupt gene flow and metapopulation dynamics, and
lead to the genetic isolation of populations over several generations 
[*e.g.* @zachos_genetic_2007].

Considered transversally, LTIs thus generate a demonstrated negative
fragmenting effect on biodiversity, but considered longitudinally, LTIs have
the potential to constitute a habitat and/or movement corridors for
biodiversity by their semi-natural verges [@seiler_effects_2003]. Indeed,
inside the LTI boundaries there is generally a transportation lane (road,
railway, pipeline, powerline, river or canal) and verges which are most often
covered with vegetation (road and railway embankments, strips of grass under
power lines or above buried pipelines, or waterway banks, etc.). Studies
assessing the potential of LTI verges as habitat and/or corridor for wildlife
species have provided contrasted results. For instance, road verges sometimes
contain significant portions of the remaining populations of rare plant
species [@yates_assessing_2002; @helldin_abundance_2015]. On the other hand,
the alteration of the original habitat induced by the construction of transport
infrastructure can favour the establishment and spread of exotic plants 
[*e.g.* @greenberg_roadside_1997; @meunier_roads_2012].
The potential of LTI verges as habitat and/or corridor for wildlife species may
also vary with verge management practices, as one practice (e.g. mowing) can be
beneficial for some species (e.g. disturbance-tolerant species) but not for
others (e.g. woody species) [@forman_roads_1998; @le_viol_plant_2008].

Knowing the role of LTI verges as habitat and/or corridor for biodiversity is
of importance as verges might contribute to ecological networks. In the last
decades, ecological networks of terrestrial and aquatic continuities
(blue-green infrastructures) aiming to decrease fragmentation have received
much attention from scientists and policymakers [@bennett_linkages_2003].
Meta-analyses of corridor effectiveness showed that, overall, corridors
increase movements of plants, vertebrates and invertebrates between habitat
patches, but that corridor effectiveness varies among taxa 
[@gilbert-norton_meta-analytic_2010; @resasco_meta-analysis_2019].
Maintaining such a network of ecological corridors might be beneficial on the
long term in the context of climate change by facilitating species dispersal to
newly suitable areas  [@heller_biodiversity_2009]. In France, the concept of
green and blue infrastructures led to the development of a public policy named
“Trame Verte et Bleue” (meaning green and blue ecological network) launched by
the French Ministry of Ecology in 2007. Accordingly, French administrative
regions have identified ecological networks and they conduct action plans for
preserving and restoring these continuities, for biodiversity. At a smaller
spatial scale, i.e. townships, it has also to be considered in local urban
planning.


## Topic identification and stakeholder input

In France, the LTI network is very dense. For instance, the road network is the
longest (over a million kilometres long, ¼ of the European network) and one of
the densest (1.77 km/km²) of the European Union. As a comparison, Spain, which
has an area close to the one of France, has a road density six times lower
(0.32 km/km²). The railway network is also one of the longest in Europe with
more than 30,000 kilometres of railway lines in use. Thus, such a dense LTI
network means a considerable inherent surface of verges and LTI managers might
substantially contribute to ecological networks. Furthermore, in the
literature, the potential for LTI verges to be a habitat and/or a corridor for
biodiversity seems to exist, but a comprehensive understanding of the
conditions where this is true remains, as far as we know, unavailable. Seminal
reviews on this question were previously published 
[_e.g._ @trombulak_review_2000; @forman_roads_1998; @farhig_effects_2009] but they
focused on roads and do not fulfil the standards of a systematic review
[@pullin_guidelines_2006]. This situation motivated several French LTI managing
companies and the French Ministry of Ecology to request a systematic review on
this issue, at the heart of the green and blue infrastructure public policy.
The French LTI managing companies are gathered in an informal group, named
“Club des Infrastructures Linéaires & Biodiversité” (CILB), aiming at acting
for biodiversity conservation. The motorway, railway, power line, pipeline and
waterway French stakeholder companies who are members of the CILB were
specifically interested in evaluating whether their LTI verges could
contribute to green and blue infrastructures to improve the management of
these verges for that purpose. The systematic review was assumed to be a
relevant scientific method to provide a sound answer to this practical
questioning from LTI managers. A call for tender for a systematic review was
thus launched by the French Ministry of Ecology and the French Agency for
Environment and Energy Management (ADEME) through its research incentive
program related to transportation ecology, named “Infrastructures de
Transport Terrestre, Écosystèmes et Paysage” (ITTECOP), supported by the CILB
and the “Fondation pour la Recherche sur la Biodiversité” (FRB), a French
foundation supporting research in biodiversity. The French National Museum of
National History (MNHN) was then chosen for conducting the project, in
collaboration with the Franch National Institute of Research, Agriculture and
Environment (Inrae), the University Pierre and Marie Curie (UPMC, Paris 6),
the French Centre for Studies and Expertise on Risks, Environment, Mobility,
and Urban and Country Planning (Cerema). At the beginning of the project, the
LTI managers funding the study were met to list the types of verges they own
and the management practices they apply on those, to define the components of
the review question.

The protocol of the systematic review was published in 2016 [@jeusset_can_2016]. Because the
question encompasses all biodiversity, a very large number of articles were
collected. The review process was thus split by taxa in three stages. A first
systematic review focusing on insects was published in 2018 [@villemey_can_2018]. A second
systematic review on vertebrates (mammals, birds, amphibians and reptiles;
organisms like fishes that are not living on or using verges but exclusively
live in or use the LTI itself were not considered in this review) was published
in 2020 [@ouedraogo_can_2020]. Regarding insects, our systematic review revealed that their
abundance was generally not statistically different between LTI verges and away
from LTIs. Insect abundance was even higher on non-highway road verges than
away from roads. 
Regarding vertebrates, highway verges had higher abundance of small mammals but
both lower abundance and species richness of birds than away from highways. The
opposite pattern was found howerver for bird species richness and abundance
along waterways.
Here, we propose a third systematic review on flora to complement the two previous
ones. 


## Objective of the review

The general aim of the review was to determine if LTI verges can provide
habitats or dispersal corridor for flora (i.e. all vascular plants except
stricly aquatic plants). This work exclusively focused on the longitudinal
effect of LTI verges without considering the transversal effect of LTIs such as
barrier effects. The review also aims at assessing the effects of managements
practices (e.g., mowing), as well as of the characteristics of the surrounding
landscape, on the potential of LTI verges for vascular plants. 

### Primary question

The primary question of the review is: can linear transportation infrastructure
verges constitue habitats and/or corridor for vascular plants in temperate
ecosystems?

### Secondary questions

The approach in this review consisted in splitting the above primary question
into six specific questions detailed in Table 1. This subdivision was used
during study validity assessment and the synthesis of evidence.

We defined LTI verges as the area up to 30 m from roadways, waterways or
railways, or the area (whatever the width) below power lines or below/above
pipelines. We considered the surrounding landscape to be at, at least, 1 km
around the LTI.

### Components of the primary question

Population: All vascular plant (except strictly aquatic plants) species and
communities.

Exposure: LTI verges; i.e. road, railway, powerline and pipeline verges and
waterway banks. Regarding the latter, as our systematic review focused on LTIs,
we only considered navigable waterways (navigable rivers and canals) as
relevant exposures.

Intervention: Management practices (e.g. mowing) or human-induced disturbances
(_e.g._ waterway channelization) on LTI verges. 

Comparator: Temporal and/or spatial comparators, including but not restricted
to ecosystem present before versus after infrastructure construction (LTI verge
creation), LTI verge before versus after management intervention), LTI verge
versus nearby similar habitats away from LTIs, LTI verge managed with one
practice versus unmanaged LTI verge or LTI verges managed with a different
practice. 

Outcomes: All outcomes relating to species presence or species dispersal,
including but not restricted to species richness, abundance, community
composition and species dispersal. 

Context: Because the funders requested an evidence synthesis applicable to
western Europe, we restricted our synthesis to temperate zones.


# Methods

The methods are described in details in an a priori systematic review protocol
[@jeusset_can_2016]. We summarize it here and present the small deviations from this protocol
that we made when conducting the review. The methods follow the Collaboration
for Environmental Evidence (CEE) Guidelines and Standards for Evidence
Synthesis in Environmental Management 
[@collaboration_for_environmental_evidence_guidelines_2018] unless noted otherwise.

## Search for articles

### Search strings

The review team identifed English search terms to be combined in search
strings. For all keywords listed wild-cards may be used to allow the use of
derivations of the word’s root and to account for the possibility of finding a
word in various spellings (English from Great Britain or from the United
States) and with various endings (singular or plural). 

We tested a first search string combining some of the search terms with Boolean
operators of Web Of Science Core Collection (with search on “Topic”). To assess
the comprehensiveness of the search string, we compared the search hits to the
articles of the test list indexed in the database (see Additional file ***XXX*** for
the list of articles of the test list and how it was constituted). Then, we
modifed the search string by removing some of the search terms and including
new ones, to increase the number of articles of the test list retrieved 
[@jeusset_can_2016].
At last, the search string that produced the highest efficiency (i.e. total
number of search hits as low as possible with the highest number of articles
from the test list retrieved) was a set of four sub-search strings displayed in
Table 2. 

#### Publication databases

We first listed the databases to which the members of our review team had
access. The database selection was then based on three criteria 
[@jeusset_can_2016]:

* Topic: the database(s) had to cover ecology; 
* Accessibility/reproducibility/sustainability: the database(s) had to be accessible by the whole review team, and by researchers all over the world (as a guarantee of reproducibility and further reviewing); 
* Comprehensiveness: number of articles indexed in the database(s) among the
  articles of the test list (Additional file ***XXX***)

These criteria led us to select two databases: Web Of Science Core Collection
(with subscriptions: Science Citation Index Expanded 1956-present, Social
Sciences Citation Index 1975-present, Arts and Humanities Citation Index
1975-present, Conference Proceedings Citation Index-Science 1990-present,
Conference Proceedings Citation Index-Social Science & Humanities 1990-present,
Book Citation Index-Science 2005-present, Book Citation Index-Social Sciences
and Humanities 2005-present, Emerging Sources Citation Index 2015-present,
Current Chemical Reactions 1985-present, and Index Chemicus 1993-present; 86
articles indexed out of the 102 articles of the test list) and Zoological
Records (subscribed timespan 1864-present, 51 articles out of the 102
articles). Searches on these two databases were made on “Topic”.

#### Search engines

 We performed additional searches using three search engines: 

* Google Scholar (https://scholar.google.fr/); 
* BASE (Bielefeld Academic Search Engine, https:// www.base-search.net/); 
* CORE (https://core.ac.uk/). Because these search engines could only handle a limited number of search terms and did not allow the use of all wildcards, the search strings used for publication databases were simplified. We thus developed a search string for each of the five LTIs (Additional file 3). In Google Scholar, results were sorted by relevance, with the boxes “include patents” and “include citations” unchecked. In BASE, results were sorted by relevance, with the box “boost open access documents” unchecked and the box “Verbatim search” checked. For each of the five search strings, we retrieved the first 20 hits.

#### Specialist websites

We searched for links or references to relevant articles and data on 11
specialist websites including a journal special issue on transportation ecology
(Additional file 4).

#### Supplementary searches

To retrieve grey literature, we contacted by email national and international
experts of transportation ecology, through the Ecodif (now SFEcodif),
Transenviro, Wftlistserv and IENE mailing lists and by posting a call on social
media (https://fr.linkedin.com/). SFEcodif is a French mailing list about
ecology and evolution which counted around 7000 subscribers (https://www.sfeco
logie.org/sfecodif/), and Transenviro, Wftlistserv and IENE mailing lists are
international mailing lists about transportation ecology. Together, the
Transenviro and Wftlistserv mailing lists (http://www.itre.ncsu.edu/CTE/
Lists/index.asp) gathered about 600 contacts and the IENE mailing list
(http://www.iene.info/) counted around 300 contacts. All these mailing lists
were accessed on 22 September 2015. Eventually, we contacted nearly two
thousand people (N=1902) by individual email. Organizations funding the
systematic review also provided us with their unpublished reports. As well,
some experts spontaneously sent us documents on flora after having heard about
our project (see below).

#### Dates of literature searches

Literature searches were performed in three stages. First, we performed
searches in Web Of Science Core Collection publication database, in Zoological
Records publication database, and in Google Scholar search engine on April 27th
2015, February 1st 2016, and March 4th to 9th 2016, respectively. The call for
grey literature was performed on April 21st 2015. All articles published in
2016 were not considered during these first searches.

Second, searches were updated on June 15th 2018 for Web Of Science Core
Collection and Zoological Records publication databases, and on November 6th
2018 for Google Scholar, to retrieve articles published from 2016 onward until
these dates (Additional file 4). New searches on specialist websites were
conducted from November 26th 2018 to December 4th 2018, and searches on BASE
and CORE search engines were updated on November 7th and 8th 2018,
respectively.

Third, we performed an update from articles published between 2018 and 2020 on
March 3rd, 2021 for Web Of Science Core Collection (N=6193 articles) and
Zoological Records publication databases (N=1240 articles). Due to time
restriction, no update was conducted however for the other sources of
literature (Google Scholar, CORE, BASE). There was no update of the call for
grey literature either, but we received spontaneously documents from experts by
emails: on 20th October 2021 from Mayenne Nature Environnement (N=10 articles)
and on the 15 November 2021 from Frédéric Hendoux, director of the Conservation
Botanique National du Bassin Parisien (N=4 articles).

Finally, articles from a previsouly published review on roadside management
were included into our review (Jakobsson 2018).

## Article screening and study eligibility criteria

### Screening process

The articles collected from online publication databases were screened by
several member of the review team for eligibility (according to the criteria
described in the next section) through three successive stages : first on
titles (performed by SV, AV, AJ, RS, MV, EG, EM, VR, LP), second on abstracts
(performed by SV, AV, AJ, RS, MV, EG, EM, VR, AC, YB, LP), and third on
full-texts (performed by LP, VF, VR, SV, AV, AJ, AC, DYO, EG, EM, MV, RS, PP,
VA, YB, YR). The number of articles screened by each member of the review team
is detailed in the supplementary file ***XXX***.

The screening is conservative at each stage : in cases of doubt, articles
proceed to the next stage for further assessment. The agreement between
screener was assessed before beginning a screening stage (title, abstract or
full-text screening stage) by computing a Randolph’s Kappa coefficient
[@jeusset_can_2016] on a number of references randomly sampled among the
database of articles about flora. These randomly sampled articles were screened
by each of the reviewers independently of each other.
We considered 200, 20 and 50  randomly sampled references to be sufficient to
assess the agreement between screeners during title, abstract and full-text
screening, respectively. It is a relatively small proportion of the total
number of references to be screened, but these numbers were based on our
experience with the previous systematic reviews published on insects and then
on vertebrates [@villemey_can_2018; @ouedraogo_can_2020]. A minimal coefficient
of 0.6 was considered an acceptable level of agreement between reviewers. All
disagreements were discussed by reviewers, so that diferences in screeners’
understanding of eligibility criteria could be resolved. When the coefficient
was lower than 0.6 the operation was repeated until reaching a coefficient
larger than 0.6.

### Eligibility criteria

At each stage of screening, article eligibility was based on a list of
selection criteria. At the stage of title screening, these criteria mainly
encompassed both the subject (ecology and related disciplines) and the
population and exposure/intervention of the article (Table  3). The same
criteria were applied at the stage of abstract screening, to which we added
criteria regarding the exposure/intervention, the comparator, the outcomes or
the study type (Table  4). Articles without abstract were discarded due to
their high number and time constraints, and as this protocol was followed for
the previous two reviews of our project. Finally, the same criteria as for the
abstract stage were used for the stage of full-text screening, to which we
added new inclusion criteria regarding the language, the climate, the type of
publication or the specifc questions covered (Table 5). We considered that a
study was not relevant to the purpose of the review, and thus discarded it, if
the comparator was inappropriate (comparison between diferent seasons,
comparator difcult to interpret for the purposes of this review, high contrast
of habitat with the comparator (e.g. herbaceous vegetation compared to forest),
etc.], if the sampling was not strictly done on verges (we defined LTI verges
as the area up to 30 m from roadways, waterways, or railways, or the area
(whatever the width) below power lines or below/above pipelines), or if—for
questions Q5 and Q6—the landscape scale was below 1 km. As our review focused
on transportation infrastructures, we also made sure at full-text screening
stage that only paved roads and navigable rivers and canals were included. This
information is unfortunately rarely provided for waterways, so we included all
articles with Strahler [@strahler_quantitative_1957] stream order above three,
canals and rivers, and we excluded all articles with stream order equal or
below three and articles with no information on stream order.

To identify whether study area was in the temperate climate we used the
Köppen–Geiger Climate Classifcation (Cfa, Cfb, Cfc, Csa, Csb, Csc, see
[http://people.eng.unimelb.edu.au/mpeel/koppen.html](http://people.eng.unimelb.edu.au/mpeel/koppen.html)
for the GoogleEarth layers of the Köppen–Geiger Climate Classification). When a
study area overlapped temperate and non-temperate climate with no possibility
to extract the data regarding only the temperate climate the study was
discarded. Similarly, studies were excluded if the results included
biological groups and/or exposures that were not under the scope of the
review, with no possibility to extract results scoping the review (e.g.
results combining aquatic and riparian flora, or combining vascular flora and
lichen or bryophytes, results combining paths and paved roads, results
combining streams and rivers). We also checked for data redundancy (data
already published in another article included in the review) and added this
factor as an exclusion cause. Articles about non vascular plant species were
set aside during the three stages of title, abstract and full-text
screenings.

## Study validity assessment

We conducted a critical appraisal of the studies and assigned them a low,
medium or high risk of bias. To define the criteria of this appraisal, eight
external experts in landscape connectivity and transportation ecology were
gathered and consulted during a 1-day workshop with seven scientists of our
review team [@jeusset_can_2016]. During the workshop, we discussed about the
gold standard protocol of an ideal study answering our primary question with
unlimited resources (unlimited money, time, workforce, etc.). We considered
that a study was unreliable because of a high risk of bias, and therefore
excluded it from the review, if there was/were:

* A total absence of replications; 
* An inadequate methodology (for example for question Q4 on the role of
  corridor of verges, a statistical analysis of dispersal data that did not
  allow to distinguish LTI verges from other habitats); 
* A method description strongly insufficient (i.e. when it was not possible to
  know where the sampling was done: within or outside LTI verges); 
* Major confounding factors (e.g. strong difference in sampling effort between
  treatment and control)

We considered that a study had a medium risk of bias if it had the following
characteristics: 

* Absence of transparent and systematic procedure for the selection of sample
  plot location (i.e. randomization, fixed distances, grids); 
* Control–Intervention and Before–After–Intervention study designs (as opposed
  to Before–After– Control–Intervention study designs) for the specifc
  questions involving verge management (questions Q1 and Q3); 
* Absence of true spatial replication of the study (for example study with
  repetition of measures on a unique site); 
* Attrition bias (difference in the loss of samples between control and
  treatment); 
* Method description slightly insufcient (some minor details were missing but
  did not challenge our understanding of the methods). 

Finally, we considered that a study that did not have a high or medium risk of
bias had a low risk of bias. Studies with a high risk of bias were discarded
from synthesis. In the narrative synthesis, the results of studies with a low
risk of bias were first synthesized and then the consistency of the results of
studies with a medium risk of bias was assessed. In the meta-analyses, the
infuence of the level of bias (low or medium) on effect sizes was furthermore
tested. For articles dealing with more than one specifc question (Table 1), we
performed critical appraisal for each question separately, that we considered
being different studies. The critical appraisal was performed as follows:
first, each study was critically appraised by one reviewer (VF). Then, a second
reviewer critically appraised again the uncertain cases.
We compared conclusions of the two reviewers, and when they differed, they
discussed disagreements until reaching a consensus and asked for a third
reviewer if necessary. All reviewers never had to critically appraise article they authored by
themselves. Although it is a CEE standard that at least two people
independently critically appraise each study, it was not possible in this study
due to the high number of articles and time constraints.

## Data coding and extraction strategy

### Extraction of meta-data

We used the coding tool displayed in Table 6 to produce an easily searchable
database of the studies included after critical appraisal (i.e. with low and
medium risk of bias). If an article dealt with more than one of our specific
questions, we coded each question in a different row.


### Extraction of data for narrative synthese

For all specific questions except Q2 (for which data was extracted for
meta-analyses only), we first extracted into tables the statistically tested
results of all studies with low and medium bias. For each species or
group of species we extracted the effects of exposure/intervention and
categorized them as positive, negative or neutral. Neutral effects referred to
comparison between control and treatment that were statistically not signifcant
(_i.e._ no statistically signifcant difference between the two, α=0.05). Where
necessary, we assessed whether the differences were statistically signifcant
using the confidence intervals reported by the authors. Data extraction was
performed by VF (Q3, Q4 and Q6) and HM (Q1 and Q5). 

### Extraction of data for meta-analyses

For each primary study, and for both LTI verges and control sites away from
LTIs, sample sizes, outcome means, and measures of variation (standard
deviation, standard error, or confidence interval) were extracted from tables,
text, published raw data (e.g. in appendices), and graphics using the R package
“metaDigitise” version 1.0.1. [@pick_reproducible_2019]. 
When outcome means or measures of variation could not be directly extracted
from the published data, the sample size and any other measure that enable
further imputation according to Lajeunesse [@lajeunesse_recovering_2013] (e.g
upper- and lower inter-quartile ranges, statistical tests parameters) were
extracted. In case of uncertainty of the measure of variation reported (i.e.
when it was impossible to know whether it was the standard deviation or the
standard error that was reported), standard errors were assumed to obtain
conservative estimates of the uncertainty around the effect sizes calculated.
Abundance for either species groups or individual species were extracted. If a
study reported the abundances for both a group and some particular individual
species from the group we only used the former.
Similarly, if total abundance or richness were given alongside data for
specific subgroups (e.g. annuals, forbs, or ruderals), only global values were
used except if the grouping concerned the native or exotic/invasive status of species, in
which case results were also extracted in addition to the global ones.
When studies measured the biodiversity of vascular plants at various distances
from LTI verges we used values of the furthest distance as controls. When
studies reported multiple measures along a distance gradient within the
boundaries of the LTI verges, means and standard deviations were
combined and used to compute a single effect size. Finally,
if a study reported several sites that could serve as a control, the site with
habitat most similar to LTI verges was chosen as control. Data extraction was
performed by one reviewer (HM). 

## Potential effect modifiers/reasons for heterogeneity

We recorded the following potential effect modifiers as
stated in the protocol of the present review [@jeusset_can_2016]:

* Geographic location;
* Biological groups studied;
* Site characteristics: type of LTI, type of habitat of the
verge/comparator sites and level of contrast between them;
* Verge management practices (mowing, grazing, vegetation burning, pesticide
  use, etc.);
* Comparator type (spatial/temporal, etc.);
* Selection of sampling location (randomization, fixed distances or grids
  versus directed sampling).
Although identified as a potential reason for heterogeneity in the review
protocol, we eventually considered the absence of replicates as an important
source of bias. Accordingly, those articles without replicates were discarded
during critical appraisal.



# Results

```{r}

library(data.table)
library(ggplot2)
library(metafor)
library(RColorBrewer)

data_exclusion <- fread("../R/data/SI5_articles-excluded-fulltextstage-v3.csv")
data_critical_appraisal <- fread("../R/data/SI-6-analyse-critique_v4.csv")
data_synthesis <- fread("../R/data/SI-7-included-studies_v3.csv")
data_metaanalysis <- fread("../R/data/DATAOK_metaanalysesCOHNECSIT_ITTECOP.csv")

# Calculate percentage of cases for each level of categorical variable
get_prct_cases <- function(data, column) {
  l <- list()
  categories <- unique(data[[column]])
  results <- vector("numeric", length(categories))
  for (i in seq_along(categories)) {
    v <- (sum(data[[column]] == categories[i]) / length(data[[column]])) * 100
    l[[paste0("Percent_cases_", categories[i])]] <- v
  }
  return(l)
}

```

## Literature search retrieval


### Literature searches and screening

Searches about the role of linear transportation infrastructure as habitat
and/or corridor for biodiversity returned 93014 articles from 1972 to 2020
(74062 from the initial search retrieval and 18 952 from the
actualisation in 2020).
After the title screening stage, 10775 articles concerning vascular
plants were accepted.
During the abstract screening stage, we rejected 6778
articles from the corpus, yielding `r nrow(data_exclusion)` articles for full-text
screening.
We could not retrieve full-texts for 
`r nrow(data_exclusion[Reasons_for_rejection == "Pdf cannot be obtained"])` 
articles (
`r paste0(round((nrow(data_exclusion[Reasons_for_rejection == "Pdf cannot be obtained"]) / nrow(data_exclusion)) * 100), "%")` 
) and among the other articles, 
`r nrow(data_critical_appraisal[Corpus %in% c("Initial", "NO_Abstract")])`
were accepted for critical appraisal from the
litterature search retrieval (see ROSES flow diagram in Figure **XXX**).
For articles that were rejected at full-text screening, the most common reasons
for exclusions were: that sites were not in the bioclimatic region of interest
(
`r paste0(round((nrow(data_exclusion[Reasons_for_rejection == "Sites are not in the bioclimatic region"]) / nrow(data_exclusion)) * 100, 1), "%")`
), that the type of a study was not appropriate (_e.g_ a simulation study ; 
`r paste0(round((nrow(data_exclusion[Reasons_for_rejection == "The study type is inappropriate (no data, simulation, recommendation)"]) / nrow(data_exclusion)) * 100), "%")`
) and that there was no appropriate comparator (
`r paste0(round((nrow(data_exclusion[Reasons_for_rejection == "The comparator is inappropriate"]) / nrow(data_exclusion)) * 100), "%")`
).

A posteriori, some articles were included in the screening process (Figure **XXX**).
Indeed, we considered 50 articles from the review of Jakobsson et al. (2018).
This recent review assessed the role of ILT infrastructure management on the
flora biodiversity. As it corresponds to our question Q1, we included articles which
were not already in our corpus. 
One of them was lacking an abstract was and therefore excluded during abstract screening,
no PDF could be obtained for 7 articles, 25 articles were excluded at the title
screening stage and `r nrow(data_critical_appraisal[Corpus == "Revue_2018"])` 
articles were included in the critical appraisal stage. The exclusions of the
25 articles was either because studies were not conducted under a temperate
climate (76%), or because the document was written in a language other than
English or French (24%).
Later in the search process, we also received 10 and four articles by mail from
experts (Mayenne Nature Environnement and Conservatoire botanique national du
Bassin parisien, respectively). However, these articles were all excluded from the screening
process at the full-text stage. Indeed, four of them were reviews and the others were
rejected because of the type of study or because the exposure criteria were not
met.

Thus, at the end of the screening phase, `r nrow(data_critical_appraisal)` articles remained (Figure **XXX**). 
The articles rejected at full-text screening as well as those for which we did
not find full-texts are listed in Additional file **XXX** with reason for exclusion
(also detailed in Figure **XXX**).


### Study validity assessment

```{r}

N_studies_all_bias <- nrow(data_critical_appraisal)
N_studies_medium_low_bias <- nrow(data_critical_appraisal[Risk_of_bias %in% c("Low", "Medium")])
N_articles_all_bias <- length(unique(data_critical_appraisal$ID_doc))
N_articles_medium_low_bias <- length(unique(data_critical_appraisal[Risk_of_bias %in% c("Low", "Medium"), ID_doc]))

# cat(paste(N_studies_all_bias, N_studies_medium_low_bias, N_articles_all_bias, N_articles_medium_low_bias, '\n', sep = '\n'))

```

Because an article can answer to more than one of our specific subquestions, the
`r N_articles_all_bias` articles included in the review were split into 
`r N_studies_all_bias` diferent studies that underwent critical appraisal. 
At this stage, `r N_studies_all_bias - N_studies_medium_low_bias` studies were excluded from further synthesis because
they showed a high risk of bias.
The reasons for a high risk of bias were a strongly insufficient description of the method (
`r paste0(round((nrow(data_critical_appraisal[Reasons_for_rejection %in% c("High risk of bias (method description strongly insufficient)", "High risk of bias (major counfounding factor and method description strongly insufficient)" )]) / nrow(data_critical_appraisal)) * 100), "%")`
), the presence a major confounding factor (
`r paste0(round((nrow(data_critical_appraisal[Reasons_for_rejection %in% c("High risk of bias (major confounding factor)", "High risk of bias (major confounding factor and method description strongly insufficient)" )]) / nrow(data_critical_appraisal)) * 100, 2), "%")`
), an inadequate methodology (
`r paste0(round((nrow(data_critical_appraisal[Reasons_for_rejection %in% c("High risk of bias (inappropriate protocol)" )]) / nrow(data_critical_appraisal)) * 100, 2), "%")`
), an absence of replication (
`r paste0(round((nrow(data_critical_appraisal[Reasons_for_rejection %in% c("High risk of bias (no replication)" )]) / nrow(data_critical_appraisal)) * 100, 2), "%")`
) and protocols varying between control and treatment (
`r paste0(round((nrow(data_critical_appraisal[Reasons_for_rejection %in% c("High risk of bias (protocol varies between control and treatment)" )]) / nrow(data_critical_appraisal)) * 100, 2), "%")`
) or between sites(
`r paste0(round((nrow(data_critical_appraisal[Reasons_for_rejection %in% c("High risk of bias (protocol varies between sites)" )]) / nrow(data_critical_appraisal)) * 100, 2), "%")`
).
Thus, a total of `r N_studies_medium_low_bias` studies corresponding to `r N_articles_medium_low_bias` articles were
retained after critical appraisal.
Additional file **XXX** provides a list of all studies retained after the
screening stage with coded metadata and their risk of bias assessed
during critical appraisal. The number of studies of each level of bias for
every subquestion and type of LTI is also given in Figure **XXX**.

After the critical appraisal stage, `r nrow(data_synthesis[Included_in_narrative_synthesis == "Yes"])` studies with a low or medium risk of
bias that reported statistical results for any subquestion except Q2 were further included in the narrative synthesis.
The `r nrow(data_synthesis[LTI == "Road" & Specific_question == "Q2"])` studies with a low or medium risk of bias dealing with Q2
were scanned separately for means and error measures for control and treatment
sites in order to compute effect sizes for a meta-analysis on the role of
habitat of LTI verges.
Among them, `r nrow(data_synthesis[Included_in_metaanalysis == "Yes"])`
studies provided the necessary data for *Species richness* and/or *Abundance*. 

### Characteristics of the studies

```{r}

N_included_studies <- nrow(data_synthesis[Included_in_systematic_review == "Yes"])

```

Of the `r N_included_studies` with low or medium risk of bias,
`r paste0(round((nrow(data_synthesis[Risk_of_bias == "low"]) / nrow(data_synthesis[Risk_of_bias %in% c("low", "medium")])) * 100, 2), "%")`
had a low risk of bias (Figure **XXX**). The majority of studies dealt with the
role of habitat of verges by comparing biodiversity within the boundaries of
LTI verges to biodiversity in similar habitats away from the verges (Q2 ; 
`r nrow(data_synthesis[Specific_question == "Q2" & Risk_of_bias %in% c("low", "medium")])`
studies), and with the impact of management practices on the biodiversity hosted by
comparing LTI verges under different management regimes or perturbation levels (Q1 ; 
`r nrow(data_synthesis[Specific_question == "Q1" & Risk_of_bias %in% c("low", "medium")])`
studies). A relatively high number of studies also investigated the effect of the surrounding landscape on the habitat role of verges (Q5 ;
`r nrow(data_synthesis[Specific_question == "Q5" & Risk_of_bias %in% c("low", "medium")])`
studies). 
However, studies addressing the role of corridor of verges were very scarce. Indeed, there were only
<!-- `r nrow(data_synthesis[Specific_question == "Q4" & Risk_of_bias %in% c("low", "medium")])` -->
3 studies on the role of corridor of LTI verges (Q4), 
<!-- `r nrow(data_synthesis[Specific_question == "Q3" & Risk_of_bias %in% c("low", "medium")])` -->
1 study on the impact of management practices on the role of corridor and
<!-- `r nrow(data_synthesis[Specific_question == "Q6" & Risk_of_bias %in% c("low", "medium")])` -->
2 studies on the influence of the surrounding landscape.


### Publication year

The
`r length(unique(data_synthesis$ID_doc))` articles retained after critical
appraisal were published from `r min(data_synthesis[,Publication_year])`
to `r max(data_synthesis[,Publication_year])` (**Figure XXX**).

### Source

Most of the
`r nrow(data_synthesis)`
studies retained after critical appraisal were retrieved from 
Web Of Science Core Collection (
`r nrow(data_synthesis[Source == "WOSCC"])`
articles). Only 
`r nrow(data_synthesis[Source == "ZR"])` studies
came from Zoological Records and only
`r nrow(data_synthesis[Source == "GoogleScholar"])`
from Google Scholar.
The call for grey litterature eventually led to
`r nrow(data_synthesis[Source == "email request"])` studies
being included in the final corpus and

`r nrow(data_synthesis[Source == "ITTECOP"])`
studies were also spontaneously sent to
us. Lastly,
`r nrow(data_synthesis[Source == "REVIEW2018"])`
studies came from the review of Jakobsson et al. (2018) on the impact of
management practices of road verges on biodiversity.


### Language and type of article

The vast majority of the studies included in the synthesis came from documents written in English
(
`r paste0(round(get_prct_cases(data_synthesis, "Language")$Percent_cases_English, 1), "%")`
), the remainder being written in French.
Almost articles included came from scientific journal (
`r paste0(round(get_prct_cases(data_synthesis, "Article_Type")$Percent_cases_Article, 1), "%")`
), but the review also included
`r nrow(data_synthesis[Article_Type == "Technical_report"])` technical reports,
`r nrow(data_synthesis[Article_Type == "PhD_thesis"])` PhD thesis chapters and
`r nrow(data_synthesis[Article_Type == "Master_thesis"])` Master thesis chapters, as well as
`r nrow(data_synthesis[Article_Type == "Talk"])` Powerpoint presentation and
`r nrow(data_synthesis[Article_Type == "Book_chapter"])` book chapter.


### Study location

At country level, most of the `r N_included_studies` were done in the United States
(
`r paste0(round(get_prct_cases(data_synthesis, "Country")$Percent_cases_USA, 1), "%")`
) and France (
`r paste0(round(get_prct_cases(data_synthesis, "Country")$Percent_cases_France, 1), "%")`
), then in Spain (
`r paste0(round(get_prct_cases(data_synthesis, "Country")$Percent_cases_Spain, 1), "%")`
), Australia (
`r paste0(round(get_prct_cases(data_synthesis, "Country")$Percent_cases_Australia, 1), "%")`
) or in the United Kingdom (
`r paste0(round(get_prct_cases(data_synthesis, "Country")$Percent_cases_UK, 1), "%")`
; see Figure **XXX** for a full list).


### Study design

Most studies included in the synthesis had a Control-Exposure (for questions Q2, Q4, Q5, Q6) or a Control-Intervention (for questions Q1 and Q3) design (respectively 
`r paste0(round(get_prct_cases(data_synthesis, "Study_design")$Percent_cases_CE, 1), "%")` and
`r paste0(round(get_prct_cases(data_synthesis, "Study_design")$Percent_cases_CI, 1), "%")`
of the studies). Only
`r paste0(round((100 - (get_prct_cases(data_synthesis, "Study_design")$Percent_cases_CI + get_prct_cases(data_synthesis, "Study_design")$Percent_cases_CE)), 1), "%")`
of the studies however included a temporal control by assessing biodiversity
both before and after the intervention/exposure.


### Exposures

The majority of the `r N_included_studies` studies were about roads (
`r nrow(data_synthesis[LTI == "Road"])`
). Waterways were the second most studied LTI with
`r nrow(data_synthesis[LTI == "Waterway"])` studies. On the other hand, only
`r nrow(data_synthesis[LTI == "Powerline"])`,
`r nrow(data_synthesis[LTI == "Railway"])` and
`r nrow(data_synthesis[LTI == "Pipeline"])` studies were done along powerlines,
railways and pipelines respectively.


## Data synthesis: quantitative syntheses

```{r}

N_studies_metaanalysis <- length(unique(data_metaanalysis$Author_date))
N_cases_metaanalysis <- nrow(data_metaanalysis)
N_cases_metaanalysis_global <- nrow(data_metaanalysis[Global_analysis == "Yes"])

# Cases/Studies by outcome
dt_number_of_studies_cases_outcome <- data_metaanalysis[, .(N_studies = uniqueN(Study.ID), N_cases = .N), keyby = .(Response_variable)]
N_cases_metaanalysis_abundance <- dt_number_of_studies_cases_outcome[Response_variable == "Abundance", N_cases]
N_cases_metaanalysis_species_richness <- dt_number_of_studies_cases_outcome[Response_variable == "Species_richness", N_cases]
N_studies_metaanalysis_abundance <- dt_number_of_studies_cases_outcome[Response_variable == "Abundance", N_studies]
N_studies_metaanalysis_species_richness <- dt_number_of_studies_cases_outcome[Response_variable == "Species_richness", N_studies]

# Cases/studies by LTI
dt_number_of_studies_cases_LTI <- data_metaanalysis[, .(N_studies = uniqueN(Study.ID), N_cases = .N), keyby = .(ILT_analysis)]

```

### Description of the data

We extracted quantitative data from `r N_studies_metaanalysis` among
the `r N_studies_medium_low_bias` with a low or medium risk of bias
addressing the specific question Q2 ("Is tracheophyte biodiversity in LTI
verges equal to, higher, or lower than in similar habitats away from the
LTIs?"). 
Among the `r N_cases_metaanalysis` extracted from these 
`r N_studies_metaanalysis`, `r N_cases_metaanalysis_abundance` cases in 
`r N_studies_metaanalysis_abundance` studies concerned species or group abundance,
and `r N_cases_metaanalysis_species_richness` in `r N_studies_metaanalysis_species_richness`
studies concerned species richness (Additional file ***XXX***).

We estimated the variance of cases with data imputation (*i.e.* filling missing
variance by using the available data from the other studies) for
`r nrow(data_metaanalysis[is.na(Measure_var_treatment),])` 
cases (
`r  paste0(round((nrow(data_metaanalysis[is.na(Measure_var_treatment) & Response_variable == "Abundance",]) / N_cases_metaanalysis_abundance) * 100, 1), "%")`
of *Abundance* cases and 
`r  paste0(round((nrow(data_metaanalysis[is.na(Measure_var_treatment) & Response_variable == "Species_richness",]) / N_cases_metaanalysis_species_richness) * 100, 1), "%")`
of *Species richness* cases).
When several cases were extracted from the same study, this was because there
was data for several species or group of species, for several sites, or for several years or seasons.

Most of the cases in our data were conducted along roads (highways 
`r paste0(round(get_prct_cases(data_metaanalysis, "ILT_analysis")$Percent_cases_Highway, 1), "%")`
) and non-highway roads (
`r paste0(round(get_prct_cases(data_metaanalysis, "ILT_analysis")$Percent_cases_Non_Highway_road, 1), "%")`
), then along powerlines (
`r paste0(round(get_prct_cases(data_metaanalysis, "ILT_analysis")$Percent_cases_Powerline, 1), "%")`
),
pipelines (
`r paste0(round(get_prct_cases(data_metaanalysis, "ILT_analysis")$Percent_cases_Pipeline, 1), "%")`
) and railways (
`r paste0(round(get_prct_cases(data_metaanalysis, "ILT_analysis")$Percent_cases_Railway, 1), "%")`
).

Cases extracted for the meta-analysis were mostly from studies conducted in North America and Europe (North America:
`r paste0(round(get_prct_cases(data_metaanalysis, "Continent")$Percent_cases_North_America, 1), "%")`
, Europe:
`r paste0(round(get_prct_cases(data_metaanalysis, "Continent")$Percent_cases_Europe , 1), "%")`
, Oceania:
`r paste0(round(get_prct_cases(data_metaanalysis, "Continent")$Percent_cases_Oceania , 1), "%")`
, South America:
`r paste0(round(get_prct_cases(data_metaanalysis, "Continent")$Percent_cases_South_America , 1), "%")`
, and Asia:
`r paste0(round(get_prct_cases(data_metaanalysis, "Continent")$Percent_cases_Asia , 1), "%")`
).


### Meta-analyses and publication bias


```{r}
# %>% Grand Mean effect models

GM <- rma.mv(
  yi=yi,
  V=vi,
  mods= ~1,
  random= ~1 | Author_date/Case.ID,
  data=data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes",],
  method="REML"
)

GM_no_influential_cases <- rma.mv(
  yi=yi,
  V=vi,
  mods= ~1,
  random= ~1 | Author_date/Case.ID, data=data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),],
  method="REML"
)

GM_SR <- rma.mv(
  yi=yi,
  V=vi,
  mods= ~1,
  random= ~1 | Author_date/Case.ID,
  data=data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",],
  method="REML"
)

# Tables with numeric results for different models
dt_GM <- data.table(
  Model_ID = "Grand mean - Abundance",
  Coeff = round(GM$b[1], 2),
  ci_supp = round(GM$ci.ub, 2),
  ci_inf = round(GM$ci.lb, 2),
  QE =GM$QE,
  QE_pvalue = ifelse(GM$QEp == 0, "p < 0.0001", paste0("p = ", round(GM$QEp, 2))),
  N = GM$k
)

dt_GM_no_influential_cases <- data.table(
  Model_ID = "Grand mean - Abundance - No influential cases",
  Coeff = round(GM_no_influential_cases$b[1], 2),
  ci_supp = round(GM_no_influential_cases$ci.ub, 2),
  ci_inf = round(GM_no_influential_cases$ci.lb, 2),
  QE = GM_no_influential_cases$QE,
  QE_pvalue = ifelse(GM_no_influential_cases$QEp == 0, "p < 0.0001", paste0("p = ", round(GM_minus_influential_cases$QEp, 2))),
  N = GM_no_influential_cases$k
)

dt_GM_SR <- data.table(
  Model_ID = "Grand mean - Species richness",
  Coeff = round(GM_SR$b[1], 2),
  ci_supp = round(GM_SR$ci.ub, 2),
  ci_inf = round(GM_SR$ci.lb, 2),
  QE = GM_SR$QE,
  QE_pvalue = ifelse(GM_SR$QEp < 0.001, "p < 0.001", paste0("p = ", round(GM_SR$QEp, 2))),
  N = GM_SR$k
)

dt_GM_results <- rbindlist(list(dt_GM, dt_GM_no_influential_cases, dt_GM_SR))

```

For abundance, overall we found that vascular plants were marginally less
abundant on LTI compared to similar habitats away from verges (grand mean effect size 
`r paste0("d=", dt_GM_results[1, Coeff])`,
95% confidence interval (95% CI)
`r paste0("[",dt_GM_results[1, ci_inf], ";", dt_GM_results[1, ci_supp], "]")`
). However, this negative relationship could be attributed mainly to two highly
influential cases (Cook's distance above 0.5) and when they were removed, the
overall grand mean effect size became positive but was not statistically different
from zero (
`r paste0("d=", dt_GM_results[2, Coeff])`,
95% CI
`r paste0("[", dt_GM_results[2, ci_inf], ";", dt_GM_results[2, ci_supp], "]")`
). Hence based on this more robust estimate, abundance on the verges did not
seem to differ from the one observed in reference sites. We also found high heterogeneity
between effect sizes (
jk`r paste0("Q_T=",round(dt_GM_results[2, QE], 1), ", ", dt_GM_results[2, QE_pvalue], "N=", dt_GM_results[2, N])`
), indicating that moderators could explain variations in effect sizes.

For species richness, the overall mean effect size was not statistically different from 0 (
`r paste0("d=", dt_GM_results[3, Coeff])`,
95% CI
`r paste0("[",dt_GM_results[3, ci_inf], ";", dt_GM_results[3, ci_supp], "]")`
),
meaning that LTI verges and reference sites also exhibited similar numbers of
species overall. Again, we found a statistically significant heterogeneity in
the effect sizes (
`r paste0("Q_T=",round(dt_GM_results[3, QE], 1), ", ", dt_GM_results[3, QE_pvalue], "N=", dt_GM_results[2, N])`
).


```{r}
# %>% Risk of bias - funnel plots and Egger's tests

# Number of cases and studies by Outcome / LTI
# (data_metaanalysis[Global_analysis == "Yes", .(N_studies = uniqueN(Study.ID), N_cases = .N), keyby = .(Response_variable, ILT_analysis)])

# for Abundance
data_metaanalysis$ILT_analysis <- factor(data_metaanalysis$ILT_analysis, levels=c("Highway","Non_Highway_road","Powerline", "Pipeline", "Railway"))
data_metaanalysis <- data_metaanalysis[order(ILT_analysis, Status_analysis, yi),]
mod <- rma.mv(
    yi ~ ILT_analysis - 1, random = ~1 | Author_date/Case.ID, V=vi, 
    data = data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway",],
    method = "REML"
)
mod

#resi <- rstudent(mod)$resid
#mod$ni <- data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway",]$ni
#par(mfrow=c(1,1))
#funnel(resi, ni=mod$ni, yaxis = "ni", digits = 0, main = "Abundance", back="white")
#mod$vi <- data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway",]$vi
#regtest(x=resi, vi=mod$vi, ni=mod$ni, predictor="ni", model="lm")
#
# for Abundance without inflential cases
mod <- rma.mv(
    yi ~ ILT_analysis - 1, V=vi, random= ~1 | Author_date/Case.ID,
    data=data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),],
    method="REML"
)
mod

resi <- rstudent(mod)$resid
mod$ni <- data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),]$ni
#par(mfrow=c(1,1))
#funnel(resi, ni=mod$ni, yaxis = "ni", digits = 0, main = "Abundance", back="white", ylim=c(0, 200))
mod$vi <-  data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),]$vi

egger_test_abundance <- regtest(x=resi, vi=mod$vi, ni=mod$ni, predictor="ni", model="lm")
egger_test_abundance_pval <- round(egger_test_abundance$pval, 2)

## for Species richness
mod <- rma.mv(yi ~ ILT_analysis - 1, random = ~1 | Author_date/Case.ID, V=vi, 
             data = data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes" ,], method = "REML")
mod

resi <- rstudent(mod)$resid
mod$ni <- data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",]$ni
#par(mfrow=c(1,1))
#funnel(resi, ni=mod$ni, yaxis = "ni", digits = 0, main = "Species_richness", back="white")
mod$vi <- data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",]$vi
egger_test_SR <- regtest(x=resi, vi=mod$vi, ni=mod$ni, predictor="ni", model="lm")
egger_test_SR_pval <- egger_test_SR$pval.

#data_metaanalysis[Response_variable == variable & Global_analysis == "Yes",][which(data_metaanalysis[Response_variable == variable & Global_analysis == "Yes",]$ni>300),]

```

```{r}
# %>% Correlation effect size ~ year

dotsize <- function(vi){
  wi=1/(vi)
  0.5 + 3 * (wi - min(wi))/(max(wi) - min(wi))
}
mygrey <- rgb(100,100,100,50,maxColor=255)

# Correlation Abundance ~ Publication data
rho_abundance_year <- with(data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes",],
     cor.test(yi,date))
rho_abundance_year_pval <- rho_abundance_year$p.value
rho_abundance_year <- rho_abundance_year$estimate

#summary(lm(yi  ~ date, data = data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes",]))

# Correlation Species_richness ~ Publication data
rho_SR_year <- with(data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",],
     cor.test(yi,date))
rho_SR_year_pval <- rho_SR_year$p.value
rho_SR_year <- rho_SR_year$estimate

#summary(lm(yi  ~ date, data = data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",]))
#
## %>% Plots of the mean cumulative meta-analysis by publication year
#
## for Abundance
#CMA <- data.frame()
## ordonne le fichier par annee de publication
#d <- data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes",][order(date),]
## Model with random Author_date/Case.ID on intercept
#for(i in unique(d$date)[-1]){
#  m <- rma.mv(yi=yi, V=vi, mods= ~1, random= ~1 | Author_date/Case.ID, data=d[date <= i,], method="REML")  
#  CMA <- rbind(CMA, data.frame(
#    Date = i, k = m$k, tau2 = m$tau2,
#    b = m$b, ci.lb = m$ci.lb, ci.ub = m$ci.ub))
#}
#with(CMA, plot(b, as.integer(as.character(Date)), xlab = expression("Mean effect size " %+-% " 95% CI"), ylab = "", yaxt = "n", xlim=c(min(ci.lb),max(ci.ub+0.2)), main="Abundance"))
#with(CMA, segments(ci.lb, as.integer(as.character(Date)), ci.ub, as.integer(as.character(Date)), lwd= 5, col= 'grey'))
#with(CMA, points(b, as.integer(as.character(Date)), pch= 21, bg = 'white', cex = 1))
#with(CMA, text(ci.ub, as.integer(as.character(Date)), pos= 4, labels = as.integer(as.character(Date)), cex = 1))
#abline(v = 0, lty = 5)
#
#
## for Species richness
#d <- data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",][order(date),]
#CMA <- data.frame()
## Model with random Author_date/Case.ID on intercept
#for(i in unique(d$date)[-1]){
#  m <- rma.mv(yi=yi, V=vi, mods= ~1, random= ~1 | Author_date/Case.ID, data=d[date <= i,], method="REML")  
#  CMA <- rbind(CMA, data.frame(
#    Date = i, k = m$k, tau2 = m$tau2,
#    b = m$b, ci.lb = m$ci.lb, ci.ub = m$ci.ub))
#}
#with(CMA, plot(b, as.integer(as.character(Date)), xlab = expression("Mean effect size " %+-% " 95% CI"), ylab = "", yaxt = "n", xlim=c(min(ci.lb),max(ci.ub+0.7)), main="Species_richness"))
#with(CMA, segments(ci.lb, as.integer(as.character(Date)), ci.ub, as.integer(as.character(Date)), lwd= 5, col= 'grey'))
#with(CMA, points(b, as.integer(as.character(Date)), pch= 21, bg = 'white', cex = 1))
#with(CMA, text(ci.ub, as.integer(as.character(Date)), pos= 4, labels = as.integer(as.character(Date)), cex = 1))
#abline(v = 0, lty = 5)

```

There was no striking evidence of publication bias neither for abundance nor
for species richness from the funnel plots and the plot of the cumulative
meta-analysis by publication year (Additional file **XXX**).
Egger’s regression test for funnel plot asymmetry indicated that
there was no statistically significant asymmetry neither for abundance (P-value = `r egger_test_abundance_pval`) and species richness (P-value = `r egger_test_SR_pval`).
Similarly, publication was not significantly correlated to publication year, neither for abundance (`r paste0("r=", rho_abundance_year)`, `r paste0("P-value=", rho_abundance_year_pval)`),
nor for species richness (`r paste0("r=", rho_SR_year)`, `r paste0("P-value=", rho_SR_year_pval)`).
Finally, we did not detect any influence of the risk of bias of the study (low
or medium) on effect sizes (after removing the effect of type of LTI) for none
of the outcome category.

```{r}
# %>% Effect of risk of bias level

## for Abundance
#with(droplevels(data_metaanalysis[Response_variable == "Abundance",]), table(Bias, ILT_analysis))
#with(droplevels(data_metaanalysis[Response_variable == "Abundance",]), chisq.test(Bias, ILT_analysis))
##with(droplevels(data_metaanalysis[Response_variable == "Abundance",]), montestchi2(table(Bias, ILT_analysis)))
#
#mdd <- rma.mv(yi ~ Bias -  1, random = ~1 | Author_date/Case.ID, V=vi, data = data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway",], method = "REML")
#mod <- rma.mv(yi ~ ILT_analysis -  1, random = ~1 | Author_date/Case.ID, V=vi, data = data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway",], method = "REML")
#resi <- rstudent(mod)$resid
#mdddat <- cbind(data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway",], resi)
#rma.mv(resi ~ Bias -  1, random = ~1 | Author_date/Case.ID, V=vi, data = mdddat, method = "REML")
#
#mdd <- rma.mv(yi ~ Bias -  1, random = ~1 | Author_date/Case.ID, V=vi, data = data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),], method = "REML")
#mod <- rma.mv(yi ~ ILT_analysis -  1, random = ~1 | Author_date/Case.ID, V=vi, data = data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),], method = "REML")
#resi <- rstudent(mod)$resid
#mdddat <- cbind(data_metaanalysis[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),], resi)
#rma.mv(resi ~ Bias -  1, random = ~1 | Author_date/Case.ID, V=vi, data = mdddat, method = "REML")
#
#par(mfrow=c(2,2))
#plot(mdddat$yi ~ as.factor(mdddat$Bias))
#plot(mdddat$resi ~ as.factor(mdddat$Bias))
#
## for Species richness
#with(droplevels(data_metaanalysis[Response_variable == "Species_richness",]), table(Bias, ILT_analysis))
#with(droplevels(data_metaanalysis[Response_variable == "Species_richness",]), chisq.test(Bias, ILT_analysis))
##with(droplevels(data_metaanalysis[Response_variable == "Species_richness",]), montestchi2(table(Bias, ILT_analysis)))
#
#mdd <- rma.mv(yi ~ Bias -  1, random = ~1 | Author_date/Case.ID, V=vi, data = data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",], method = "REML")
#mod <- rma.mv(yi ~ ILT_analysis -  1, random = ~1 | Author_date/Case.ID, V=vi, data = data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",], method = "REML")
#resi <- rstudent(mod)$resid
#mdddat <- cbind(data_metaanalysis[Response_variable == "Species_richness" & Global_analysis == "Yes",], resi)
#rma.mv(resi ~ Bias -  1, random = ~1 | Author_date/Case.ID, V=vi, data = mdddat, method = "REML")
#

```

### Effects of moderators on abundance


### Effects of moderators on species richness


```{r}
## %>% Effect of moderators
#
#data_metaanalysis[Global_analysis == "Yes" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"), .(N_studies = uniqueN(Study.ID), N_cases = .N), keyby = .(Response_variable, ILT_analysis)]
#
#data_metaanalysis[Status_analysis %in% c("Native", "Exotic"), .(N_studies = uniqueN(Study.ID), N_cases = .N), keyby = .(Response_variable, Status_analysis, ILT_analysis)]
#
##!#!#!#!#!#!#!#!#!#!  FONCTIONS #!#!#!#!#!#!#!#!#!#!  
### fonction pour faire le plot des moderateurs automatiquement (from Isabelle Witte)
#plot.coefs <- function(x, data, col = "lightblue", pch = 21, bg = "white", 
#                       cex = 1.4, lty = 1, lwd = 5, xlab = '', titre, my_ylim=FALSE, ylimi,
#                       ylab = expression("Estimated effect size " %+-% " 95% CI")){
#  b = data$b
#  ci.lb = data$ci.lb
#  ci.ub = data$ci.ub
#  #ylim= c((min(ci.lb)-.25*(max(ci.ub)-min(ci.lb))), max(ci.ub))  
#  if(my_ylim == TRUE){
#    plot(x, b, xlim= c(min(x) - 0.5, max(x) + 0.5), ylim=ylimi, ylab = ylab, xlab = xlab, xaxt = 'n', main = titre)
#  }else{
#    plot(x, b, xlim= c(min(x) - 0.5, max(x) + 0.5), ylim=c(min((min(ci.lb)-.25*(max(ci.ub)-min(ci.lb))),-1.5),max(ci.ub)), ylab = ylab, xlab = xlab, xaxt = 'n', main = titre)
#  }
#  segments(x, ci.lb, x, ci.ub, lwd = lwd, col = col, lty = lty)
#  points(x, b, pch= 21, cex = 1, bg = bg)
#}
#
##!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#! 
#
#coul <- brewer.pal(9, "BuPu") 
#coula <- brewer.pal(9, "Blues")
#coulb <- brewer.pal(5, "Oranges")
#
#dat <- data_metaanalysis
#dat$ILT_analysis <- factor(dat$ILT_analysis, levels=c("Highway","Non_Highway_road","Powerline", "Pipeline", "Railway"))
#dat$Status_analysis <- factor(dat$Status_analysis, levels=c("Mixed","Exotic","Native"))
#dat[Status_analysis == "Mixed", color := coulb[4]]
#dat[Status_analysis == "Native", color := coula[8]]
#dat[Status_analysis == "Exotic", color := coula[5]]
#dat[Status_analysis == "Mixed", tpch := 16]
#dat[Status_analysis == "Native", tpch := 15]
#dat[Status_analysis == "Exotic", tpch := 18]
#dat <- dat[order(ILT_analysis, Status_analysis, yi),]
#
## -- ILT for global data
### Abundance
#mod1 <- rma.mv(yi ~ ILT_analysis - 1, random = ~1 | Author_date/Case.ID, V=vi, 
#              data = dat[Global_analysis == "Yes" & Response_variable == "Abundance" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2") & ILT_analysis != "Railway",], method = "REML")
#mod1
#
#dt_results_mod1_model <- data.table(
#    Model_ID = "Global / ILT - Abundance",
#    QM =mod1$QM,
#    QM_pvalue = ifelse(mod1$QM == 0, "p < 0.0001", paste0("p = ", round(mod1$QMp, 2))),
#    QE =mod1$QE,
#    QE_pvalue = ifelse(mod1$QEp == 0, "p < 0.0001", paste0("p = ", round(mod1$QEp, 2))),
#    N = mod1$k
#)
#
#dt_results_mod1_coeff <- data.table(
#    LTI = substr(names(coef(mod1)),13,50),
#    Coeff = round(coef(mod1), 2),
#    ci_supp = round(mod1$ci.ub, 2),
#    ci_inf = round(mod1$ci.lb, 2),
#    N = dat[Response_variable == "Abundance" & Global_analysis == "Yes" & ILT_analysis != "Railway" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"), .(group = .N), keyby = .(ILT_analysis)][,2]
#)
#
#
### Species richness
#mod2 <- rma.mv(yi ~ ILT_analysis - 1, random = ~1 | Author_date/Case.ID, V=vi, 
#              data = dat[Global_analysis == "Yes" & Response_variable == "Species_richness",], method = "REML")
#mod2
#
#dt_results_mod2_model <- data.table(
#    Model_ID = "Global / ILT - Species richness",
#    QM =mod2$QM,
#    QM_pvalue = ifelse(mod2$QM == 0, "p < 0.0001", paste0("p = ", round(mod2$QMp, 2))),
#    QE =mod2$QE,
#    QE_pvalue = ifelse(mod2$QEp == 0, "p < 0.0001", paste0("p = ", round(mod2$QEp, 2))),
#    N = mod2$k
#)
#
#dt_results_mod2_coeff <- data.table(
#    LTI = substr(names(coef(mod2)),13,50),
#    Coeff = round(coef(mod2), 2),
#    ci_supp = round(mod2$ci.ub, 2),
#    ci_inf = round(mod2$ci.lb, 2),
#    N = dat[Response_variable == "Species_richness" & Global_analysis == "Yes", .(group = .N), keyby = .(ILT_analysis)][,2]
#)
#
#
## -- ILT / Plant status
### Abundance
#
## Non_Highway_road 
#mod3 <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = dat[ILT_analysis == "Non_Highway_road" & Status_analysis %in% c("Exotic", "Native") & Response_variable == "Abundance",], method = "REML")
#mod3
#
#dt_results_mod3_model <- data.table(
#    Model_ID = "Road / Status - Abundance",
#    QM =mod3$QM,
#    QM_pvalue = ifelse(mod3$QM == 0, "p < 0.0001", paste0("p = ", round(mod3$QMp, 2))),
#    QE =mod3$QE,
#    QE_pvalue = ifelse(mod3$QEp == 0, "p < 0.0001", paste0("p = ", round(mod3$QEp, 2))),
#    N = mod3$k
#)
#
#dt_results_mod3_coeff <- data.table(
#    LTI = substr(names(coef(mod3)),16,50),
#    Coeff = round(coef(mod3), 2),
#    ci_supp = round(mod3$ci.ub, 2),
#    ci_inf = round(mod3$ci.lb, 2),
#    N = dat[Response_variable == "Abundance" & ILT_analysis == "Non_Highway_road" & Status_analysis %in% c("Native", "Exotic"), .(group = .N), keyby = .(Status_analysis)][,2]
#)
#
## Powerlines
#mod4 <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = dat[ILT_analysis == "Powerline" & Status_analysis %in% c("Exotic", "Native") & Response_variable == "Abundance",], method = "REML")
#mod4
#
#dt_results_mod4_model <- data.table(
#    Model_ID = "Powerline / Status - Abundance",
#    QM =mod4$QM,
#    QM_pvalue = ifelse(mod4$QM == 0, "p < 0.0001", paste0("p = ", round(mod4$QMp, 2))),
#    QE =mod4$QE,
#    QE_pvalue = ifelse(mod4$QEp == 0, "p < 0.0001", paste0("p = ", round(mod4$QEp, 2))),
#    N = mod4$k
#)
#
#dt_results_mod4_coeff <- data.table(
#    LTI = substr(names(coef(mod4)),16,50),
#    Coeff = round(coef(mod4), 2),
#    ci_supp = round(mod4$ci.ub, 2),
#    ci_inf = round(mod4$ci.lb, 2),
#    N = dat[Response_variable == "Abundance" & ILT_analysis == "Powerline" & Status_analysis %in% c("Native", "Exotic"), .(group = .N), keyby = .(Status_analysis)][,2]
#)
#
### Species richness
## Non Highway roads
#mod5 <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = dat[ILT_analysis == "Non_Highway_road" & Status_analysis %in% c("Exotic", "Native") & Response_variable == "Species_richness",], method = "REML")
#mod5
#
#dt_results_mod5_model <- data.table(
#    Model_ID = "Road / Status - SR",
#    QM =mod5$QM,
#    QM_pvalue = ifelse(mod5$QMp < 0.001, "p < 0.001", paste0("p = ", round(mod5$QMp, 2))),
#    QE =mod5$QE,
#    QE_pvalue = ifelse(mod5$QEp < 0.001, "p < 0.001", paste0("p = ", round(mod5$QEp, 2))),
#    N = mod5$k
#)
#
#dt_results_mod5_coeff <- data.table(
#    LTI = substr(names(coef(mod5)),16,50),
#    Coeff = round(coef(mod5), 2),
#    ci_supp = round(mod5$ci.ub, 2),
#    ci_inf = round(mod5$ci.lb, 2),
#    pval = round(mod5$pval, 2),
#    N = dat[Response_variable == "Species_richness" & ILT_analysis == "Non_Highway_road" & Status_analysis %in% c("Native", "Exotic"), .(group = .N), keyby = .(Status_analysis)][,2]
#)
#
#dt_results_models <- rbind(
#    dt_results_mod1_model,
#    dt_results_mod2_model,
#    dt_results_mod3_model,
#    dt_results_mod4_model,
#    dt_results_mod5_model
#)
#
```

```{r}
# %>% Plot effect sizes by ILT and ILT / Status


###!#!#!#!#!#!#!#!#!#!  FONCTIONS #!#!#!#!#!#!#!#!#!#!  
### fonction pour faire le plot des moderateurs automatiquement (from Isabelle Witte)
#plot.coefs <- function(x, data, col = "lightblue", pch = 21, bg = "white", 
#                       cex = 1.4, lty = 1, lwd = 5, xlab = '', titre, my_ylim=FALSE, ylimi,
#                       ylab = expression("Estimated effect size " %+-% " 95% CI")){
#  b = data$b
#  ci.lb = data$ci.lb
#  ci.ub = data$ci.ub
#  #ylim= c((min(ci.lb)-.25*(max(ci.ub)-min(ci.lb))), max(ci.ub))  
#  if(my_ylim == TRUE){
#    plot(x, b, xlim= c(min(x) - 0.5, max(x) + 0.5), ylim=ylimi, ylab = ylab, xlab = xlab, xaxt = 'n', main = titre)
#  }else{
#    plot(x, b, xlim= c(min(x) - 0.5, max(x) + 0.5), ylim=c(min((min(ci.lb)-.25*(max(ci.ub)-min(ci.lb))),-1.5),max(ci.ub)), ylab = ylab, xlab = xlab, xaxt = 'n', main = titre)
#  }
#  segments(x, ci.lb, x, ci.ub, lwd = lwd, col = col, lty = lty)
#  points(x, b, pch= 21, cex = 1, bg = bg)
#}
#
##!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#!#! 
#
#coul <- brewer.pal(9, "BuPu") 
#coula <- brewer.pal(9, "Blues")
#coulb <- brewer.pal(5, "Oranges")
#
## Data for plots
#data_plot <- data_metaanalysis
#
#data_plot$ILT_analysis <- factor(data_plot$ILT_analysis, levels=c("Highway","Non_Highway_road","Powerline", "Pipeline", "Railway"))
#data_plot$Status_analysis <- factor(data_plot$Status_analysis, levels=c("Mixed","Exotic","Native"))
#data_plot[Status_analysis == "Mixed", color := coulb[4]]
#data_plot[Status_analysis == "Native", color := coula[8]]
#data_plot[Status_analysis == "Exotic", color := coula[5]]
#data_plot[Status_analysis == "Mixed", tpch := 16]
#data_plot[Status_analysis == "Native", tpch := 15]
#data_plot[Status_analysis == "Exotic", tpch := 18]
#data_plot <- data_plot[order(ILT_analysis, Status_analysis, yi),]
#
## Global -- ILT analysis
### Abundance
#
#mod1 <- rma.mv(yi ~ ILT_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, 
#              data = data_plot[Response_variable == "Abundance" & Global_analysis == "Yes" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2") & ILT_analysis != "Railway",], method = "REML")
#mod1
#
### Species_richness
#mod1b <- rma.mv(yi ~ ILT_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, 
#              data = data_plot[Global_analysis == "Yes" & Response_variable == "Species_richness",], method = "REML")
#mod1b
#
## ILT / Native - Exotic
#
### Abundance
## Exotic/Native on "Non_Highway_road"
#mod2 <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = data_plot[Response_variable == "Abundance" & ILT_analysis == "Non_Highway_road" & Status_analysis %in% c("Exotic", "Native"),], method = "REML")
#mod2
#
## Exotic/Native on "Powerline"
#mod3 <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = data_plot[Response_variable == "Abundance" & ILT_analysis == "Powerline" & Status_analysis %in% c("Exotic", "Native") & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),], method = "REML")
#mod3
#
## Native on "Pipeline"
#mod4 <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = data_plot[Response_variable == "Abundance" & Status_analysis == "Native" & ILT_analysis == "Pipeline" & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2"),], method = "REML")
#mod4
#
### Species richness 
## Exotic/Native on "Non_Highway_road"
#mod2b <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = data_plot[ILT_analysis == "Non_Highway_road" & Response_variable == "Species_richness" & Status_analysis %in% c("Exotic", "Native"),], method = "REML")
#mod2b
#
## Native on "Highway"
#mod3b <- rma.mv(yi ~ Status_analysis-1, random = ~1 | Author_date/Case.ID, V=vi, data = data_plot[Response_variable == "Species_richness" & ILT_analysis == "Highway" & Status_analysis == "Native",], method = "REML")
#mod3b
#
## Combining data for different models
### Abundance
#datacoef_global_Abundance <- data.table(
#    ilt=substr(names(coef(mod1)),13,50), 
#    groups="All",
#    b=coef(mod1),
#    ci.lb=mod1$ci.lb,
#    ci.ub=mod1$ci.ub,
#    pval=mod1$pval  
#)
#datacoef_global_Abundance[,N := colSums(mod1$X)]
#N_studies_Abundance <- c(
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Highway" & Global_analysis == "Yes"]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Non_Highway_road" & Global_analysis == "Yes"]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Powerline" & Global_analysis == "Yes"  & !Case.ID %in% c("Eyitayo_2020_6", "Eyitayo_2020_2")]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Pipeline" & Global_analysis == "Yes"]$Study.ID)
#)
#datacoef_global_Abundance[, N_indep := N_studies_Abundance]
#datacoef_global_Abundance[groups == "All", color := coulb[4]]
#
#
#datacoef_status_Abundance <- rbind(
#  data.frame(ilt="Non_Highway_road",groups=substr(names(coef(mod2)),16,50), b=coef(mod2), ci.lb=mod2$ci.lb, ci.ub=mod2$ci.ub, pval=mod2$pval),
#  data.frame(ilt="Powerline",groups=substr(names(coef(mod3)),16,50), b=coef(mod3), ci.lb=mod3$ci.lb, ci.ub=mod3$ci.ub, pval=mod3$pval),
#  data.frame(ilt="Pipeline",groups="Native", b=coef(mod4), ci.lb=mod4$ci.lb, ci.ub=mod4$ci.ub, pval=mod4$pval)
#)
#datacoef_status_Abundance <- data.table(datacoef_status_Abundance)
#datacoef_status_Abundance[,N := c(colSums(mod2$X),colSums(mod3$X), colSums(mod4$X))]
#datacoef_status_Abundance <- datacoef_status_Abundance[order(ilt),]
#N_studies <- c(
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Non_Highway_road" & Status_analysis == "Exotic"]$Author_date),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Non_Highway_road" & Status_analysis == "Native"]$Author_date),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Pipeline" & Status_analysis == "Native"]$Author_date),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Powerline" & Status_analysis == "Exotic"]$Author_date),
#    uniqueN(data_plot[Response_variable == "Abundance" & ILT_analysis == "Powerline" & Status_analysis == "Native"]$Author_date)
#)
#datacoef_status_Abundance[, N_indep := N_studies]
#datacoef_status_Abundance[groups == "Native", color := coula[8]]
#datacoef_status_Abundance[groups == "Exotic", color := coula[5]]
#
### Species richness
#datacoef_global_SR <- data.table(
#    ilt=substr(names(coef(mod1b)),13,50), 
#    groups="All",
#    b=coef(mod1b),
#    ci.lb=mod1b$ci.lb,
#    ci.ub=mod1b$ci.ub,
#    pval=mod1b$pval  
#)
#datacoef_global_SR[,N := colSums(mod1b$X)]
#N_studies_SR <- c(
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Highway" & Global_analysis == "Yes"]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Non_Highway_road" & Global_analysis == "Yes"]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Powerline" & Global_analysis == "Yes"]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Pipeline" & Global_analysis == "Yes"]$Study.ID),
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Railway" & Global_analysis == "Yes"]$Study.ID)
#)
#datacoef_global_SR[, N_indep := N_studies_SR]
#datacoef_global_SR[groups == "All", color := coulb[4]]
#
#datacoef_status_SR <- rbind(
#  data.frame(ilt="Non_Highway_road",groups=substr(names(coef(mod2b)),16,50), b=coef(mod2b), ci.lb=mod2b$ci.lb, ci.ub=mod2b$ci.ub, pval=mod2b$pval),
#  data.frame(ilt="Highway",groups="Native", b=coef(mod3b), ci.lb=mod3b$ci.lb, ci.ub=mod3b$ci.ub, pval=mod3b$pval)
#)
#datacoef_status_SR <- data.table(datacoef_status_SR)
#datacoef_status_SR[,N := c(colSums(mod2b$X),colSums(mod3b$X))]
#datacoef_status_SR <- datacoef_status_SR[order(ilt),]
#N_studies <- c(
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Non_Highway_road" & Status_analysis == "Native"]$Author_date),
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Non_Highway_road" & Status_analysis == "Exotic"]$Author_date),
#    uniqueN(data_plot[Response_variable == "Species_richness" & ILT_analysis == "Highway" & Status_analysis == "Native"]$Author_date)
#)
#datacoef_status_SR[, N_indep := N_studies]
#datacoef_status_SR[groups == "Native", color := coula[9]]
#datacoef_status_SR[groups == "Exotic", color := coula[5]]
#
## Plots effect size - Abundance
#
## Global / LTI
##png("Figure_ModelEffectSize_Abundance_final.png", width = 480*1.95, height = 480)
#png("figAbondance_Global.png", width = 480*1.95, height = 480)
#
#par(mar=c(1,5,1,1), las= 1, bty= 'n', cex.lab=2, cex.axis=2)
#plot.coefs(1:nrow(datacoef_global_Abundance),data=datacoef_global_Abundance, titre="", lwd=datacoef_global_Abundance$N/sum(datacoef_global_Abundance$N)*50, col=datacoef_global_Abundance$color, my_ylim = TRUE, ylimi=c(-8,6))
#points(which(datacoef_global_Abundance$groups == "All"), datacoef_global_Abundance[groups == "All",]$b, pch=21, bg="white", cex=1.8)
##points(which(datacoef_global_Abundance$groups == "Native"), datacoef_global_Abundance[groups == "Native",]$b, pch=22, cex=1.8, bg="white")
##points(which(datacoef_global_Abundance$groups == "Exotic"), datacoef_global_Abundance[groups == "Exotic",]$b, pch=23, cex=1.8, bg="white")
#abline(h=0)
#abline(v=c(1+0.5,
#           2+0.5,
#           3+0.5), lty=3, col=8)
#text(c(0.6,
#       1+0.6,
#       2+0.7,
#       3+0.6),
#     rep(-7.2,4), c("Highways","Non highway\n    roads","Pipeline","Powerline"), pos=4, cex=1.4)
#text(1:nrow(datacoef_global_Abundance),rep(-6,nrow(datacoef_global_Abundance)),
#     c(paste(datacoef_global_Abundance[ilt == "Highway"]$N,
#          "(",
#          datacoef_global_Abundance[ilt == "Highway"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_Abundance[ilt == "Non_Highway_road"]$N,
#          "(",
#          datacoef_global_Abundance[ilt == "Non_Highway_road"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_Abundance[ilt == "Pipeline"]$N,
#          "(",
#          datacoef_global_Abundance[ilt == "Pipeline"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_Abundance[ilt == "Powerline"]$N,
#          "(",
#          datacoef_global_Abundance[ilt == "Powerline"]$N_indep,
#          ")",
#          sep="")
#     ), cex=1.6
#)
#text(which(datacoef_global_Abundance$pval < 0.05), -5.8, "*", pos=1, cex=2.2)
#
#dev.off()  
#
#png("figAbondance_Status.png", width = 480*1.95, height = 480)
#
#par(mar=c(1,5,1,1), las= 1, bty= 'n', cex.lab=2, cex.axis=2)
#plot.coefs(1:nrow(datacoef_status_Abundance),data=datacoef_status_Abundance, titre="", lwd=datacoef_status_Abundance$N/sum(datacoef_status_Abundance$N)*50, col=datacoef_status_Abundance$color, my_ylim = TRUE, ylimi=c(-8,6))
#points(which(datacoef_status_Abundance$groups == "Native"), datacoef_status_Abundance[groups == "Native",]$b, pch=22, cex=1.8, bg="white")
#points(which(datacoef_status_Abundance$groups == "Exotic"), datacoef_status_Abundance[groups == "Exotic",]$b, pch=23, cex=1.8, bg="white")
#abline(h=0)
#abline(v=c(2+0.5,
#           3+0.5), lty=3, col=8)
#text(c(1,
#       2+0.6,
#       3.5+0.6),
#     rep(-7.4,4), c("Non highway\n    roads","Pipeline","Powerline"), pos=4, cex=1.4)
#legend(0.1,6.5, lty=1, lwd=6, col=c(coula[8], coula[5]), legend=c("Native","Exotic"), bty="n", cex=1.6)
#legend(0.36,6.5, pch=c(21,22,23), pt.bg=0, pt.cex=1.4,legend=c("",""), bty="n", cex=1.6)
#text(1:nrow(datacoef_status_Abundance),rep(-6,nrow(datacoef_status_Abundance)),
#     c(paste(datacoef_status_Abundance[ilt == "Non_Highway_road"]$N,
#          "(",
#          datacoef_status_Abundance[ilt == "Non_Highway_road"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_status_Abundance[ilt == "Pipeline"]$N,
#          "(",
#          datacoef_status_Abundance[ilt == "Pipeline"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_status_Abundance[ilt == "Powerline"]$N,
#          "(",
#          datacoef_status_Abundance[ilt == "Powerline"]$N_indep,
#          ")",
#          sep="")
#     ), cex=1.4
#)
#text(which(datacoef_status_Abundance$pval < 0.05), -4.8, "*", pos=1, cex=2.2)
#
#dev.off()  
#
## Plots effect size - Species richness
#
#png("figSR_Global.png", width = 480*1.95, height = 480)
#
#par(mar=c(1,5,1,1), las= 1, bty= 'n', cex.lab=2, cex.axis=2)
#plot.coefs(1:nrow(datacoef_global_SR),data=datacoef_global_SR, titre="", lwd=datacoef_global_SR$N/sum(datacoef_global_SR$N)*50, col=datacoef_global_SR$color, my_ylim = TRUE, ylimi=c(-7,6))
#points(which(datacoef_global_SR$groups == "All"), datacoef_global_SR[groups == "All",]$b, pch=21, bg="white", cex=1.8)
##points(which(datacoef_global_SR$groups == "Native"), datacoef_global_SR[groups == "Native",]$b, pch=22, cex=1.8, bg="white")
##points(which(datacoef_global_SR$groups == "Exotic"), datacoef_global_SR[groups == "Exotic",]$b, pch=23, cex=1.8, bg="white")
#abline(h=0)
#abline(v=c(1+0.5,
#           2+0.7,
#           3+0.5,
#           4+0.5), lty=3, col=8)
#text(c(0.6,
#       1+0.6,
#       2+0.7,
#       3+0.6,
#       4+0.6),
#     rep(-6.2,4), c("Highways","Non highway\n    roads","Powerline","Pipeline", "Railway"), pos=4, cex=1.4)
#text(1:nrow(datacoef_global_SR),rep(-4.8,nrow(datacoef_global_SR)),
#     c(paste(datacoef_global_SR[ilt == "Highway"]$N,
#          "(",
#          datacoef_global_SR[ilt == "Highway"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_SR[ilt == "Non_Highway_road"]$N,
#          "(",
#          datacoef_global_SR[ilt == "Non_Highway_road"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_SR[ilt == "Powerline"]$N,
#          "(",
#          datacoef_global_SR[ilt == "Powerline"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_SR[ilt == "Pipeline"]$N,
#          "(",
#          datacoef_global_SR[ilt == "Pipeline"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_global_SR[ilt == "Railway"]$N,
#          "(",
#          datacoef_global_SR[ilt == "Railway"]$N_indep,
#          ")",
#          sep="")
#     ), cex=1.4
#)
#text(which(datacoef_global_SR$pval < 0.05), -5.8, "*", pos=1, cex=2.2)
#
#dev.off()  
#
## ILT / Plant status
#png("figSR_Status.png", width = 480*1.95, height = 480)
#
#par(mar=c(1,5,1,1), las= 1, bty= 'n', cex.lab=2, cex.axis=2)
#plot.coefs(1:nrow(datacoef_status_SR),data=datacoef_status_SR, titre="", lwd=datacoef_status_SR$N/sum(datacoef_status_SR$N)*50, col=datacoef_status_SR$color, my_ylim = TRUE, ylimi=c(-5,6))
#points(which(datacoef_status_SR$groups == "Native"), datacoef_status_SR[groups == "Native",]$b, pch=22, cex=1.8, bg="white")
#points(which(datacoef_status_SR$groups == "Exotic"), datacoef_status_SR[groups == "Exotic",]$b, pch=23, cex=1.8, bg="white")
#abline(h=0)
#abline(v=1.5, lty=3, col=8)
#text(c(0.8,       
#       1.5+0.6),
#     rep(-4.5,4), c("Highway", "Non highway\n    roads"), pos=4, cex=1.4)
#legend(0.4,6.5, lty=1, lwd=6, col=c(coula[9], coula[5]), legend=c("Native","Exotic"), bty="n", cex=1.6)
#legend(0.5,6.5, pch=c(22,23), pt.bg=0, pt.cex=1.4,legend=c("",""), bty="n", cex=1.6)
#text(1:nrow(datacoef_status_SR),rep(-3.3,nrow(datacoef_status_SR)),
#     c(paste(datacoef_status_SR[ilt == "Highway"]$N,
#          "(",
#          datacoef_status_SR[ilt == "Highway"]$N_indep,
#          ")",
#          sep=""),
#     paste(datacoef_status_SR[ilt == "Non_Highway_road"]$N,
#          "(",
#          datacoef_status_SR[ilt == "Non_Highway_road"]$N_indep,
#          ")",
#          sep="")
#     ), cex=1.4
#)
#text(which(datacoef_status_SR$pval < 0.05), -2.4, "*", pos=1, cex=2.2)
#
#dev.off()  

```
 
# References

::: {#refs}
:::


```{r}
## Specific question
## Risk_of_bias
#
#View(head(data_synthesis))
#
#library(ggplot2)
#
#ggplot(data = data_synthesis) +
#    geom_bar(mapping = aes(x = Specific_question, fill = Risk_of_bias))
#
#ggplot(data = data_synthesis) +
#    geom_bar(mapping = aes(x = , fill = Risk_of_bias))
#
```

